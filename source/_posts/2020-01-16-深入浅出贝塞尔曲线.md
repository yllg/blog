---
title: 深入浅出贝塞尔曲线
categories:
  - JS图形学与H5游戏
  - null
tags:
  - null
  - null
date: 2020-01-16 21:41:46
top:
---


# 一.介绍和应用
## 1.介绍
（1）发明：贝塞尔曲线最初由法国物理学家和数学家~保尔·德·卡斯特里奥于1959年运用德卡斯特里奥算法开发，以稳定数值的方法求出贝塞尔曲线；
（2）正式化和推广：贝塞尔曲线于1962年，由法国工程师皮埃尔·贝兹（Pierre Bézier）所广泛发表，他运用贝塞尔曲线来为汽车的主体进行设计。

## 2.应用~电脑绘图
（1）在点阵化更精细的分辨率(高分辨率)时，重新插值（补点）的计算量较小，所以贝塞尔曲线被广泛地在计算机图形中用来为平滑曲线创建模型。
（2）贝塞尔曲线是矢量图形文件和相应软件（如PostScript、PDF等）能够处理的唯一曲线，用于光滑地近似其他曲线。
（3）二次和三次贝塞尔曲线最为常用。
Photoshop的钢笔工具就是三次贝塞尔曲线；
（4）在前端开发领域，贝塞尔曲线应用也很广：css3，canvas，svg等等

# 二.贝塞尔曲线的原理
## 1.公式推导
### （1）一次方贝塞尔曲线，也叫线性贝塞尔曲线
给定点P0、P1，线性贝塞尔曲线只是一条两点之间的直线。这条线由下式给出：
![](1.jpg)

### （2）二次方贝塞尔曲线
二次方贝塞尔曲线的路径由给定点P0、P1、P2的函数B（t）追踪：
![](2.jpg)
TrueType字体就运用了以贝兹样条组成的二次贝塞尔曲线。

### （3）三次方贝塞尔曲线
P0、P1、P2、P3四个点在平面或在三维空间中定义了三次方贝塞尔曲线。
曲线的参数形式为：
![](3.jpg)
现代的成象系统，如PostScript、Asymptote和Metafont，运用了以贝兹样条组成的三次贝塞尔曲线，用来描绘曲线轮廓。

### （4）n次方贝塞尔曲线的一般公式
n阶贝塞尔曲线可如下推断。给定点P0、P1、…、Pn，其贝塞尔曲线即
![](4.jpg)
用平常话来说，n阶的贝塞尔曲线，即双n - 1 阶贝塞尔曲线之间的插值。

## 2.动图效果
### （1）线性曲线
线性贝塞尔曲线函数中的t会经过由P0至P1的B（t）所描述的曲线。
例如当t=0.25时，B（t）即一条由点P0至P1路径的四分之一处。就像由0至1的连续t，B（t）描述一条由P0至P1的直线。
![](5.gif)

###  (2)二次曲线
为建构二次贝塞尔曲线，可以中介点Q0和Q1作为由0至1的t：
由P0至P1的连续点Q0，描述一条线性贝塞尔曲线。
由P1至P2的连续点Q1，描述一条线性贝塞尔曲线。
由Q0至Q1的连续点B（t），描述一条二次贝塞尔曲线。
![](6.png)
![](7.gif)
0.25，P0 P1线段的0.25处，P1 P2线段的0.25处，两个点的连线是绿色的线
然后绿色的线也取0.25处，就是B点了

### （3）三次曲线
也是类似的，可由线性贝塞尔曲线描述的中介点Q0、Q1、Q2，和由二次曲线描述的点R0、R1所建构：
两个绿线，都取0.25，再生成蓝色的线，蓝色的线取0.25，就是B点
![](8.png)
![](9.gif)

### （4）高端曲线
四次曲线
![](10.png)
![](11.gif)
五次曲线
![](12.gif)


# 三.贝塞尔曲线在CSS3动画、SVG和canvas中的使用

## 1.css3动画与贝塞尔曲线
贝塞尔曲线决定了CSS3动画的曲线效果~ 是先快后慢呢，还是先慢后快~~
CSS3有个cubic-bezier属性, 直译为“立方-贝塞尔”，实际上是指标准三次方贝塞尔曲线；
具体用法类似：
``` bash
transition:cubic-bezier(.25,.1,.25,1)
```
三次贝塞尔曲线是4个点，这里只有两个点，因为CSS3动画贝塞尔曲线的起点和终点已经固定了，分别是(0,0)和(1,1).
在线的网址，https://cubic-bezier.com/#.25,.1,.25,1

## 2.Canvas与贝塞尔曲线
canvas有个<font color="#FF0000"> bezierCurveTo </font>方法
代码：
``` bash
var c=document.getElementById("myCanvas");
var ctx=c.getContext("2d");
ctx.beginPath();
ctx.moveTo(20,20);
ctx.bezierCurveTo(20,100,200,100,200,20);
ctx.stroke();
```
![](13.png)

开始点：moveTo(20,20)
控制点 1：bezierCurveTo(20,100,200,100,200,20)
控制点 2：bezierCurveTo(20,100,200,100,200,20)
结束点： bezierCurveTo(20,100,200,100,200,20)

## 3.svg与贝塞尔曲线
svg的path标签可以绘制任意路径，也包括贝塞尔曲线
三次贝塞尔曲线指令：C x1 y1, x2 y2, x y两个控制点(x1,y1)和(x2,y2)，(x,y)代表曲线的终点。字母C表示特定动作与行为，这里需要大写，表示标准三次方贝塞尔曲线。
代码：
``` bash
<svg width="190px" height="160px">
  <path d="M10 10 C 20 20, 40 20, 50 10" stroke="3" fill="none"/>
</svg>
```
M后面的起点，加C后面3个点，构成了贝赛尔曲线的4个点

## 4.汇总
{% blockquote %}
CSS3贝塞尔起点是0,0; 终点是1, 1;
cubic-bezier(x1,y1, x2,y2)

SVG要想与和上面一样的效果，只要：

Canvas想要和上面一样，只要：
ctx.moveTo(0,0);
ctx.bezierCurveTo(x1,y1,x2,y2,1,1);
{% endblockquote %}

# 四.深入理解SVG路径path的贝塞尔曲线指令
## 1.svg标准的指令字母是10个，外加1个非标准的
![](14.jpg)

（1）最后一个Catmull-Rom曲线不是标准的SVG命令，这里不予以讨论!
（2）如果指令字母是大写的，例如M, 则表示坐标位置是 绝对位置 ；如果指令字母小写的，例如m, 则表示坐标位置是 相对位置 。
（3）其中有5个指定属于基本指令，可理解为“好理解好上手好记忆”的指令，见下表：

![](15.jpg)

（4）剩下一个A(Arcs)弧线指令，我们 下一小节专门介绍 ；
（5）剩下的四个CSQT都是绘制贝塞尔相关的指令；

{% blockquote %}
C 三次贝塞尔曲线
S 光滑三次贝塞尔曲线
Q二次贝塞尔曲线
T 光滑二次贝塞尔曲线
{% endblockquote %}

## 2.CS一组，绘制三次贝塞尔曲线
（1）C指令
![](16.jpg)

（2）S指令
``` bash
S x2 y2, x y (or s dx2 dy2, dx dy)
```
S命令可以用来创建与前面一样的贝塞尔曲线，
(1)但是，如果S命令跟在一个C或S命令后面，则它的第一个控制点会被假设成前一个命令曲线的第二个控制点的中心对称点。
(2)如果S命令单独使用，前面没有C或S命令，那当前点将作为第一个控制点。

下面是S命令的语法示例，图中左侧红色标记的点对应的控制点即为蓝色标记点。
代码

``` bash
<?xml version="1.0" standalone="no"?><svg width="190px" height="160px" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M10 80 C 40 10, 65 10, 95 80 S 150 150, 180 80" stroke="black" fill="transparent"/>
</svg>
```
![](17.jpg)

## 3.QT一组，绘制二次贝塞尔曲线
（1）Q指令
``` bash
Q x1 y1, x y
```
![](18.jpg)

（2）T指令

``` bash
T x y (or t dx dy)
```
![](19.jpg)


和之前一样，快捷命令T会通过前一个控制点，推断出一个新的控制点。
这意味着，在你的第一个控制点后面，可以只定义终点，就创建出一个相当复杂的曲线。需要注意的是，T命令前面必须是一个Q命令，或者是另一个T命令，才能达到这种效果。
如果T单独使用，那么控制点就会被认为和终点是同一个点，所以画出来的将是一条直线。

# 五.SVG的arc圆弧指令
## 1.Arc 命令
![](20.jpg)
![](21.jpg)

## 2.第三个参数x-axis-rotation, 弧线与X轴的旋转角度
是指弧线所在的椭圆 与X轴的夹角，所以一般正圆弧这个夹角都是0度；

## 3.第四个参数large-arc-flag和第五个参数sweep-flag配合的效果
![](22.jpg)

## 4.推导圆弧的一般公式
![](23.jpg)

也就是说假设已知圆心坐标和圆心半径，逆时针方向角度为正值。
则圆弧α的起点 A 和终点 B 的坐标我们都能知道了。
所以控制一段圆弧通用的指令应该是：

``` bash
$ M Xo, Yo-r A r r 0 [1|0]** 0 Xo-r*sinα, Yo-r*cosα
注: ** 当弧角度 小于180° 时使用小角度弧线，当弧角度 大于180° 时使用大角度弧线

```

# 六.其他
1.升阶
n次贝塞尔曲线可以转换为一个形状完全相同的n+1次贝塞尔曲线。
这在软件只支持特定阶次的贝塞尔曲线时很有用。
比如，Cairo只支持三次贝塞尔曲线，你就可以用升阶的方法在Cairo画出二次贝塞尔曲线。

2.多项式表达法；

3.有理贝塞尔曲线；

等等、这里就不再深入，感兴趣的童鞋可以自己查查

# 七.参考资料
1.维基百科 《贝塞尔曲线》
https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A

2.MDN 路径-SVG
https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths

3.张鑫旭《贝塞尔曲线与CSS3动画、SVG和canvas的基情》
https://www.zhangxinxu.com/wordpress/2013/08/%e8%b4%9d%e5%a1%9e%e5%b0%94%e6%9b%b2%e7%ba%bf-cubic-bezier-css3%e5%8a%a8%e7%94%bb-svg-canvas/

4.张鑫旭《深度掌握SVG路径path的贝塞尔曲线指令》
https://www.zhangxinxu.com/wordpress/2014/06/deep-understand-svg-path-bezier-curves-command/

5.360齐舞团《SVG时间圆环日期选择器》SVG 的贝塞尔曲线
https://mp.weixin.qq.com/s/XUH8anQmW8RsCxPTeue8cQ

同时欢迎关注我的个人微信公众号：
{% img https://www.xuanbiyijue.com//img/%E5%85%AC%E4%BC%97%E5%8F%B7%E4%BA%8C%E7%BB%B4%E7%A0%81.jpg 300 300 %}
