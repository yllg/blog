---
title: 写一个类似egg的前后端通用脚手架
categories:
  - 前端工程化与持续构建
tags:
  - koa2
  - gulp
  - webpack3
  - happypack
  - ioc
  - postcss
date: 2018-01-28 14:23:44
---



### 自己写一个类似egg的前后端通用脚手架

### 运行
#### 开发环境，npm run build:dev
#### 生产环境，npm run build
#### ！脚手架搭好，就可以开始尽情表演了
{% asset_img  效果图.png 脚手架效果图 %}

### 目录结构
{% asset_img  目录结构.png 目录结构 %}


### 用到的包及其作用说明


#### node后台用gulp编译打包
（避免用webpack打包node出现过于冗余代码）

{% blockquote %}
##### babel-plugin-transform-es2015-modules-commonjs，编译import等ES6语法
{% endblockquote %}

{% blockquote %}
##### cross-env ，跨平台的设置和使用环境变量NODE_ENV
{% endblockquote %}

{% blockquote %}
##### gulp-rollup，tree shaking 代码清理
{% endblockquote %}

{% blockquote %}
##### koa-simple-router, 路由中间件
{% endblockquote %}

{% blockquote %}
##### koa-swig, 渲染swig模板，koa v2.x需要co包配合。 
{% endblockquote %}

{% blockquote %}
##### koa-static，设置静态资源文件
{% endblockquote %}

{% blockquote %}
##### log4js，配合ErrorHandler进行容错处理并打印错误日志。
{% endblockquote %}

{% blockquote %}
##### awilix，awilix-koa，实现IOC控制反转和DI依赖注入，
{% endblockquote %}

{% blockquote %}
##### babel-plugin-transform-decorators-legacy，翻译装饰器语法，使用装饰器语法 优雅的定义路由并设置路由守卫。
{% endblockquote %}




#### 前端用webpack打包

{% blockquote %}
##### better-npm-run，更方便的运行webpack配置脚本
{% endblockquote %}

{% blockquote %}
##### lodash，函数式编程的库，克隆两份配置文件，防止开发环境和生产环境配置发生混淆。
{% endblockquote %}

{% blockquote %}
##### babel-loader：翻译前端ES6语法
{% endblockquote %}

{% blockquote %}
##### happypack： webpack好盆友，项目大时可明显提升webpack打包速度
{% endblockquote %}

{% blockquote %}
##### postcss，面向未来的下一代css，使用了下面两个
{% endblockquote %}

{% blockquote %}
###### cssnext：忘掉sass,less,stylus这些旧的预处理器吧。
###### cssnano：像JS的tree shaking一样清理到无用的css，并进行css优化和压缩
{% endblockquote %}

{% blockquote %}
##### html-webpack-plugin，webpack中html文件创建的包，用它提供的钩子来扩展我们自己的一个webpack插件，将数据流中的css,js静态文件正确的插入到swig模板的正确位置。
{% endblockquote %}

{% blockquote %}
##### uglifyjs-webpack-plugin，生产环境一个超给力的压缩插件，
{% endblockquote %}

{% blockquote %}
##### copy-webpack-plugin，不需要处理的文件直接copy到build下
{% endblockquote %}


 
GitHub: [GitHub](https://github.com/yllg/WebFramework)