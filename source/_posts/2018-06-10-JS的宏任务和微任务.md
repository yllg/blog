---
title: JS的宏任务和微任务
categories:
  - JS与QA
  - null
tags:
  - null
  - null
date: 2018-06-10 17:41:56
---


## 机制原理如下：
{% asset_img ClassName 1.png  %}
{% asset_img ClassName 2.png  %}

**注意一点** 
宏任务需要<font color="#FF0000"> 多次 </font>事件循环才能执行完，微任务是<font color="#FF0000"> 一次性 </font>执行完的；
 
## 宏任务 macrotask
1.事件队列中的每一个事件都是一个macrotask

2.优先级：主代码块 > setImmediate > MessageChannel > setTimeout / setInterval 

3.举个栗子：setImmediate指定的回调函数，总是排在setTimeout前面

## 微任务 microtask
优先级：process.nextTick > Promise > MutationObserver

## 举个栗子
1.下面这个代码输出结果是什么？
{% asset_img ClassName 3.png  %}

2.揭晓答案：
主程序和和settimeout都是宏任务，两个promise是微任务
第一个宏任务（主程序）执行完，执行全部的微任务（两个promise），再执行下一个宏任务（settimeout），所以结果为：

{% asset_img ClassName 4.png  %}


同时欢迎关注我的个人微信公众号：
{% img  /img/公众号二维码.jpg 300 300 悬笔e绝 %}